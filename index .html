<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éµä¹‰ä¹‹å…‰Â·çº¢è‰²è„‰æ</title>
    <style>
        /* åŸºç¡€æ ·å¼ */
        :root {
            --primary-red: #c12c1f;
            --secondary-red: #e74c3c;
            --dark-red: #8b1a10;
            --success-green: #2e7d32;
            --error-red: #c62828;
            --gold: #f1c40f;
            --light-bg: #fff5f5;
            --text-color: #333;
            --light-text: #777;
            --border-color: #ddd;
            --card-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        body {
            font-family: 'Microsoft YaHei', 'SimHei', sans-serif;
            background: url('https://img.zcool.cn/community/01e5b55d156d0ca8012187f4b1a5f7.jpg@1280w_1l_2o_100sh.jpg') no-repeat center center fixed;
            background-size: cover;
            margin: 0;
            padding: 0;
            color: var(--text-color);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.9);
            z-index: -1;
        }
        
        /* é¡µé¢å®¹å™¨ */
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 30px auto;
        }
        
        /* å¤´éƒ¨å¯¼èˆª */
        .header {
            background: linear-gradient(to right, var(--primary-red), var(--dark-red));
            color: white;
            padding: 25px;
            text-align: center;
            border-radius: 10px 10px 0 0;
            margin-bottom: 30px;
            position: relative;
            box-shadow: var(--card-shadow);
        }
        
        .header h1 {
            margin: 0;
            font-size: 32px;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
            letter-spacing: 2px;
        }
        
        .header::after {
            content: "";
            position: absolute;
            bottom: -15px;
            left: 0;
            width: 100%;
            height: 30px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M1200 0L0 0 0 120 1200 0z" fill="%23c12c1f"></path></svg>') no-repeat;
            background-size: 100% 100%;
        }
        
        .nav {
            margin-top: 20px;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .nav a {
            color: white;
            text-decoration: none;
            margin: 0 15px;
            padding: 8px 15px;
            border-radius: 5px;
            transition: background-color 0.3s;
            font-weight: 500;
        }
        
        .nav a:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        /* å†…å®¹å¡ç‰‡ */
        .content-card {
            background-color: white;
            border-radius: 10px;
            box-shadow: var(--card-shadow);
            margin-bottom: 30px;
            overflow: hidden;
            border-top: 4px solid var(--primary-red);
        }
        
        .card-header {
            background-color: var(--light-bg);
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .card-header h2 {
            margin: 0;
            color: var(--dark-red);
            font-size: 24px;
        }
        
        .card-content {
            padding: 25px;
        }
        
        /* æ”¾å¤§çš„æŒ‰é’®æ ·å¼ï¼ˆä¿®æ”¹ä¸ºä¸¤è¡Œä¸¤åˆ—å¸ƒå±€ï¼‰ */
        .decision-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* ä¸¤è¡Œä¸¤åˆ—å¸ƒå±€ */
            gap: 20px; /* æ·»åŠ æŒ‰é’®é—´é—´è· */
            margin: 20px 0;
        }
        
        .btn {
            background: linear-gradient(to right, var(--primary-red), var(--secondary-red));
            color: white;
            border: none;
            padding: 20px 40px; /* å¢å¤§å†…è¾¹è· */
            font-size: 20px; /* å¢å¤§å­—ä½“å¤§å° */
            border-radius: 10px; /* å¢å¤§åœ†è§’ */
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 12px rgba(0, 0, 0, 0.2);
            margin: 0; /* ç§»é™¤åŸæœ‰ä¸Šä¸‹è¾¹è·ï¼Œä½¿ç”¨ grid gap */
            min-width: 200px; /* æœ€å°å®½åº¦ä¿è¯å“åº”å¼ */
            text-align: center;
        }
        
        .btn:hover {
            background: linear-gradient(to right, var(--dark-red), var(--primary-red));
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
        }
        
        .btn:disabled {
            background: #cccccc;
            transform: none;
            box-shadow: none;
            cursor: not-allowed;
        }
        
        /* å›¾ç‰‡æ ·å¼ */
        .content-image {
            width: 100%;
            height: 300px;
            object-fit: cover;
            margin: 20px 0;
            border-radius: 5px;
        }
        
        /* çº¢è‰²æ•…äº‹åˆ›ä½œå¹³å°æ ·å¼ */
        .description {
            background-color: var(--light-bg);
            border-left: 4px solid var(--primary-red);
            padding: 15px;
            margin-bottom: 25px;
            font-size: 15px;
            line-height: 1.6;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: var(--dark-red);
        }
        
        input[type="text"], input[type="password"], select, textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-size: 16px;
            box-sizing: border-box;
            transition: border 0.3s;
            font-family: inherit;
        }
        
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        input[type="text"]:focus, input[type="password"]:focus, select:focus, textarea:focus {
            border-color: var(--primary-red);
            outline: none;
            box-shadow: 0 0 5px rgba(193, 44, 31, 0.3);
        }
        
        .result-container {
            margin-top: 30px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            overflow: hidden;
        }
        
        .result-header {
            background-color: var(--primary-red);
            color: white;
            padding: 10px 15px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .result-content {
            background-color: #fff9f9;
            padding: 20px;
            min-height: 200px;
            font-size: 16px;
            line-height: 1.8;
            white-space: pre-line;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .red-star {
            color: var(--primary-red);
            margin: 0 3px;
        }
        
        .theme-options {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }
        
        .theme-option {
            background-color: var(--light-bg);
            border: 1px solid var(--border-color);
            border-radius: 5px;
            padding: 10px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .theme-option:hover {
            border-color: var(--primary-red);
            transform: translateY(-3px);
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
        }
        
        .theme-option.active {
            background-color: #ffecec;
            border-color: var(--primary-red);
            font-weight: bold;
        }
        
        .theme-option h3 {
            margin: 0 0 5px 0;
            color: var(--dark-red);
        }
        
        .theme-option p {
            margin: 0;
            font-size: 13px;
            color: var(--light-text);
        }
        
        .story-controls {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .story-controls button {
            flex: 1;
        }
        
        /* åœ°å›¾å’Œæ°‘ä¿—æ¿å—æ ·å¼ */
        #map {
            height: 500px;
            width: 100%;
            margin: 20px 0;
            border-radius: 5px;
            border: 1px solid var(--border-color);
        }
        
        .map-btn {
            padding: 8px 16px;
            background: #2c3e50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
            margin-top: 15px;
            transition: background 0.3s;
        }
        
        .map-btn:hover {
            background: #34495e;
        }
        
        .folk-container {
            display: flex;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .folk-item {
            flex: 1;
            min-width: 250px;
        }
        
        .folk-item img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 5px;
            margin-bottom: 15px;
        }
        
        /* äº’åŠ¨å†³ç­–ç»“æœ */
        #meeting-result {
            margin: 15px 0;
            padding: 10px;
            border-radius: 5px;
            font-size: 0.9em;
        }
        
        #meeting-result[style*="correct"] {
            background-color: #e8f5e9;
            color: #2e7d32;
            border-left: 4px solid #2e7d32;
        }
        
        #meeting-result[style*="error"] {
            background-color: #ffebee;
            color: #c62828;
            border-left: 4px solid #c62828;
        }
        
        /* é¡µè„š */
        .footer {
            text-align: center;
            margin-top: 30px;
            color: var(--light-text);
            font-size: 13px;
            padding: 15px;
            border-top: 1px solid var(--border-color);
        }
        
        /* å“åº”å¼è°ƒæ•´ */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 26px;
            }
            
            .nav a {
                margin: 5px;
            }
            
            .folk-container {
                flex-direction: column;
            }
            
            .theme-options {
                grid-template-columns: 1fr;
            }
            
            /* ç§»åŠ¨ç«¯å•åˆ—æ˜¾ç¤º */
            .decision-buttons {
                grid-template-columns: 1fr;
            }
        }
        
        /* æ¨¡æ€çª—å£æ ·å¼ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background-color: white;
            border-radius: 12px;
            padding: 30px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            text-align: center;
            position: relative;
            animation: modalFadeIn 0.3s;
        }
        
        @keyframes modalFadeIn {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 24px;
            color: var(--light-text);
            cursor: pointer;
            transition: color 0.3s;
        }
        
        .modal-close:hover {
            color: var(--text-color);
        }
        
        .modal-title {
            font-size: 24px;
            margin-bottom: 20px;
            font-weight: bold;
        }
        
        .modal-success .modal-title {
            color: var(--success-green);
        }
        
        .modal-error .modal-title {
            color: var(--error-red);
        }
        
        .modal-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }
        
        .modal-success .modal-icon {
            color: var(--success-green);
        }
        
        .modal-error .modal-icon {
            color: var(--error-red);
        }
        
        .modal-message {
            font-size: 17px;
            line-height: 1.8;
            margin-bottom: 25px;
            text-align: left;
        }
        
        .modal-button {
            background: linear-gradient(to right, var(--primary-red), var(--secondary-red));
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 3px 5px rgba(0, 0, 0, 0.1);
        }
        
        .modal-button:hover {
            background: linear-gradient(to right, var(--dark-red), var(--primary-red));
            transform: translateY(-2px);
            box-shadow: 0 5px 8px rgba(0, 0, 0, 0.15);
        }
        
        /* è·¯çº¿å›¾åŠ¨ç”»æ ·å¼ */
        .route-animation {
            stroke-dasharray: 1000;
            stroke-dashoffset: 1000;
            animation: dash 15s linear forwards;
        }
        
        @keyframes dash {
            to {
                stroke-dashoffset: 0;
            }
        }
        
        .zunyi-marker {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <!-- é¡µé¢å®¹å™¨ -->
    <div class="container">
        <!-- å¤´éƒ¨å¯¼èˆª -->
        <div class="header">
            <h1><span class="red-star">âœ»</span> éµä¹‰ä¹‹å…‰Â·çº¢è‰²è„‰æ <span class="red-star">âœ»</span></h1>
            <div class="nav">
                <a href="#meeting">ä¼šè®®æ¢ç§˜</a>
                <a href="#folk">æ°‘ä¿—å…±ç”Ÿ</a>
                <a href="#scenery">å…¨æ™¯èƒœæ™¯</a>
                <a href="#red-story">çº¢è‰²æ•…äº‹åˆ›ä½œ</a>
            </div>
        </div>
        <!-- ä¼šè®®æ¢ç§˜æ¿å— -->
        <div id="meeting" class="content-card">
            <div class="card-header">
                <h2>éµä¹‰ä¼šè®® Â· å†å²é‡ç°</h2>
            </div>
            <div class="card-content">
                <p>1935å¹´1æœˆï¼Œä¸­å…±ä¸­å¤®åœ¨æ­¤å¬å¼€æ”¿æ²»å±€æ‰©å¤§ä¼šè®®ï¼Œç¡®ç«‹äº†æ¯›æ³½ä¸œåŒå¿—åœ¨å…šä¸­å¤®å’Œçº¢å†›çš„é¢†å¯¼åœ°ä½ï¼Œæ˜¯å…šå†å²ä¸Šç”Ÿæ­»æ”¸å…³çš„è½¬æŠ˜ç‚¹ã€‚</p>
                <img src="./images/zunyi_meeting.jpg" alt="éµä¹‰ä¼šè®®ä¼šå€" class="content-image">
                
                <!-- æ”¾å¤§çš„äº’åŠ¨å†³ç­–æŒ‰é’®ï¼ˆä¿®æ”¹ä¸ºä¸¤è¡Œä¸¤åˆ—å¸ƒå±€ï¼‰ -->
                <h3>æ¨¡æ‹Ÿå†³ç­–ï¼šé€‰æ‹©æˆ˜ç•¥è·¯çº¿</h3>
                <div class="decision-buttons">
                    <div class="btn" onclick="showResult('correct', 'è¥¿è¿›è´µå·')">è¥¿è¿›è´µå·</div>
                    <div class="btn" onclick="showResult('error', 'åŒ—ä¸Šæ¹˜è¥¿')">åŒ—ä¸Šæ¹˜è¥¿</div>
                    <div class="btn" onclick="showResult('error', 'å—ä¸‹å¹¿ä¸œ')">å—ä¸‹å¹¿ä¸œ</div>
                    <div class="btn" onclick="showResult('error', 'ä¸œè¿›å‘è¥¿')">ä¸œè¿›å‘è¥¿</div>
                </div>
                
                <!-- å†³ç­–ç»“æœæ˜¾ç¤º -->
                <p id="meeting-result" style="color: #666; margin: 15px 0; font-size: 0.9em;"></p>
                
                <!-- è¯­éŸ³è®²è§£æŒ‰é’® -->
                <div style="margin-top: 30px;">
                    <button class="btn" onclick="playVoice('meeting')">
                        <i class="fa fa-volume-up" aria-hidden="true"></i> æ’­æ”¾ä¼šè®®è®²è§£è¯­éŸ³
                    </button>
                </div>
            </div>
        </div>
        <!-- æ°‘ä¿—å…±ç”Ÿæ¿å— -->
        <div id="folk" class="content-card">
            <div class="card-header">
                <h2>éµä¹‰æ°‘ä¿— Â· å‚©æˆä¸ç¾é£Ÿ</h2>
            </div>
            <div class="card-content">
                <div class="folk-container">
                    <div class="folk-item">
                        <h3>å‚©æˆé¢å…·</h3>
                        <img src="./images/nuoxi-mask.jpg" alt="å‚©æˆé¢å…·">
                        <p>å‚©æˆæ˜¯éµä¹‰å¤è€çš„æ°‘é—´ç¥­ç¥€æˆæ›²ï¼Œé¢å…·ä»¥æœ¨é›•ä¸ºä¸»ï¼Œå›¾æ¡ˆå¤šä¸ºç¥çµé¬¼æ€ªï¼Œè±¡å¾é©±é‚ªçº³ç¦ï¼Œ2006å¹´åˆ—å…¥å›½å®¶çº§éç‰©è´¨æ–‡åŒ–é—äº§ã€‚</p>
                        <button class="btn" onclick="playVoice('folk')">
                            <i class="fa fa-volume-up" aria-hidden="true"></i> æ’­æ”¾æ°‘ä¿—ä»‹ç»è¯­éŸ³
                        </button>
                    </div>
                    <div class="folk-item">
                        <h3>éµä¹‰ç¾Šè‚‰ç²‰</h3>
                        <img src="./images/yangroufen.jpg" alt="ç¾Šè‚‰ç²‰">
                        <p>éµä¹‰ç‰¹è‰²ç¾é£Ÿï¼Œä»¥é²œç¾Šè‚‰ã€ç§˜åˆ¶æ±¤åº•å’Œçˆ½æ»‘ç±³ç²‰ä¸ºæ ¸å¿ƒï¼Œæ­é…ç³Šè¾£æ¤’å’Œé¦™èœï¼Œé²œé¦™æµ“éƒï¼Œæ˜¯å½“åœ°äººæ—©é¤çš„"çµé­‚é€‰æ‹©"ã€‚</p>
                    </div>
                </div>
            </div>
        </div>
        <!-- çº¢è‰²æ•…äº‹åˆ›ä½œæ¿å— -->
        <div id="red-story" class="content-card">
            <div class="card-header">
                <h2><span class="red-star">âœ»</span> çº¢è‰²æ•…äº‹åˆ›ä½œå¹³å° <span class="red-star">âœ»</span></h2>
            </div>
            <div class="card-content">
                <div class="description">
                    æœ¬å¹³å°åˆ©ç”¨äººå·¥æ™ºèƒ½æŠ€æœ¯ï¼Œå¸®åŠ©æ‚¨åˆ›ä½œå¼˜æ‰¬çº¢è‰²æ–‡åŒ–ã€ä¼ æ‰¿é©å‘½ç²¾ç¥çš„ç²¾å½©æ•…äº‹ã€‚é€‰æ‹©æ•…äº‹ä¸»é¢˜ï¼Œè¾“å…¥å…³é”®ä¿¡æ¯ï¼Œå³å¯ç”Ÿæˆå¯Œæœ‰æ•™è‚²æ„ä¹‰çš„çº¢è‰²æ•…äº‹ã€‚
                </div>
                
                <div class="input-group">
                    <label for="story-theme">æ•…äº‹ä¸»é¢˜</label>
                    <div class="theme-options">
                        <div class="theme-option" data-theme="é•¿å¾æ•…äº‹">
                            <h3>é•¿å¾æ•…äº‹</h3>
                            <p>çº¢å†›é•¿å¾é€”ä¸­çš„æ„Ÿäººæ•…äº‹</p>
                        </div>
                        <div class="theme-option" data-theme="æŠ—æ—¥æˆ˜äº‰">
                            <h3>æŠ—æ—¥æˆ˜äº‰</h3>
                            <p>æŠ—æ—¥è‹±é›„çš„è‹±å‹‡äº‹è¿¹</p>
                        </div>
                        <div class="theme-option" data-theme="é©å‘½å…ˆçƒˆ">
                            <h3>é©å‘½å…ˆçƒˆ</h3>
                            <p>é©å‘½å…ˆçƒˆçš„æ„Ÿäººäº‹è¿¹</p>
                        </div>
                        <div class="theme-option" data-theme="çº¢è‰²è®°å¿†">
                            <h3>çº¢è‰²è®°å¿†</h3>
                            <p>é©å‘½æ—¶æœŸçš„çè´µå›å¿†</p>
                        </div>
                    </div>
                    <input type="text" id="story-theme" placeholder="æˆ–è‡ªå®šä¹‰ä¸»é¢˜ï¼Œå¦‚ï¼šéµä¹‰ä¼šè®®ã€äº•å†ˆå±±æ–—äº‰...">
                </div>
                
                <div class="input-group">
                    <label for="story-details">æ•…äº‹ç»†èŠ‚ï¼ˆå¯é€‰ï¼‰</label>
                    <textarea id="story-details" placeholder="æä¾›æ›´å¤šç»†èŠ‚ï¼Œå¦‚äººç‰©å§“åã€æ—¶é—´åœ°ç‚¹ã€ç‰¹åˆ«è¦æ±‚ç­‰"></textarea>
                </div>
                
                <div class="input-group">
                    <label for="story-style">æ•…äº‹é£æ ¼</label>
                    <select id="story-style">
                        <option value="æ„Ÿäººè‡³æ·±">æ„Ÿäººè‡³æ·±</option>
                        <option value="è‹±å‹‡å£®çƒˆ">è‹±å‹‡å£®çƒˆ</option>
                        <option value="å†å²çºªå®">å†å²çºªå®</option>
                        <option value="æ•™è‚²æ„ä¹‰">æ•™è‚²æ„ä¹‰</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="story-length">æ•…äº‹é•¿åº¦</label>
                    <select id="story-length">
                        <option value="300å­—å·¦å³">çŸ­ç¯‡ï¼ˆ300å­—å·¦å³ï¼‰</option>
                        <option value="500å­—å·¦å³" selected>ä¸­ç¯‡ï¼ˆ500å­—å·¦å³ï¼‰</option>
                        <option value="800å­—å·¦å³">é•¿ç¯‡ï¼ˆ800å­—å·¦å³ï¼‰</option>
                    </select>
                </div>
                
                <button id="generate-btn" class="btn" onclick="generateStory()">
                    <span id="loading-spinner" class="loading" style="display: none;"></span>
                    åˆ›ä½œçº¢è‰²æ•…äº‹
                </button>
                
                <div class="result-container">
                    <div class="result-header">
                        <span>åˆ›ä½œæˆæœ</span>
                        <span id="result-status">ç­‰å¾…åˆ›ä½œ...</span>
                    </div>
                    <div class="result-content" id="result">
                        ç”Ÿæˆçš„çº¢è‰²æ•…äº‹å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...
                    </div>
                </div>
                
                <div class="story-controls">
                    <button id="copy-btn" class="btn" onclick="copyStory()" style="background:linear-gradient(to right, #2c3e50, #4ca1af)">
                        å¤åˆ¶æ•…äº‹
                    </button>
                    <button id="download-btn" class="btn" onclick="downloadStory()" style="background:linear-gradient(to right, #27ae60, #2ecc71)">
                        ä¸‹è½½æ•…äº‹
                    </button>
                </div>
            </div>
        </div>
        <!-- å…¨æ™¯èƒœæ™¯æ¿å—ï¼ˆå«åœ°å›¾ï¼‰ -->
        <div id="scenery" class="content-card">
            <div class="card-header">
                <h2>éµä¹‰èƒœæ™¯ Â· äº‘ç«¯æ¸¸è§ˆ</h2>
            </div>
            <div class="card-content">
                <!-- åœ°å›¾å®¹å™¨ -->
                <div id="map"></div>
                
                <!-- æ™¯ç‚¹å®šä½æŒ‰é’®ï¼ˆåæ ‡æ¥è‡ªç™¾åº¦åœ°å›¾æ‹¾å–å·¥å…·ï¼‰ -->
                <div style="margin-top: 15px;">
                    <button class="map-btn" data-lat="27.6972" data-lng="106.9046">éµä¹‰ä¼šè®®ä¼šå€</button>
                    <button class="map-btn" data-lat="27.7513" data-lng="106.9912">å¨„å±±å…³</button>
                </div>
            </div>
        </div>
        <!-- é¡µè„š -->
        <div class="footer">
            <p>ä¼ æ‰¿çº¢è‰²åŸºå›  Â· å¼˜æ‰¬é©å‘½ç²¾ç¥ Â· èµ“ç»­æ–‡åŒ–è¡€è„‰</p>
            <p>Â© 2025 çº¢è‰²æ–‡åŒ–æ•°å­—åˆ›ä½œå¹³å° | Powered by çˆ±å­¦ä¹ çš„ä¸‰å§å¦¹</p>
        </div>
    </div>
    <!-- æ¨¡æ€çª—å£HTML -->
    <div id="decision-modal" class="modal">
        <div class="modal-content modal-success">
            <span class="modal-close">&times;</span>
            <div class="modal-icon">âœ…</div>
            <h2 class="modal-title">å†³ç­–æ­£ç¡®</h2>
            <div class="modal-message" id="modal-message">
                ä½ çš„å†³ç­–ä¸çœŸå®å†å²ä¸€è‡´ï¼çº¢å†›é€šè¿‡è¥¿è¿›è´µå·ï¼ŒæˆåŠŸè·³å‡ºæ•Œå†›åŒ…å›´åœˆï¼Œä¸ºé•¿å¾åç»­èƒœåˆ©å¥ å®šåŸºç¡€ã€‚
            </div>
            <button class="modal-button" onclick="closeModal()">
                æŸ¥çœ‹å…¶ä»–é€‰é¡¹
            </button>
        </div>
    </div>
    <!-- é”™è¯¯æ¨¡æ€çª—å£HTML -->
    <div id="error-modal" class="modal">
        <div class="modal-content modal-error">
            <span class="modal-close">&times;</span>
            <div class="modal-icon">âŒ</div>
            <h2 class="modal-title">å†³ç­–é”™è¯¯</h2>
            <div class="modal-message" id="error-message">
                è¯¥é€‰æ‹©ä¼šå¯¼è‡´çº¢å†›é™·å…¥ä¸åˆ©å±€é¢ï¼Œéµä¹‰ä¼šè®®åŠæ—¶çº æ­£äº†é”™è¯¯å†³ç­–ã€‚è®©æˆ‘ä»¬ä¸€èµ·å­¦ä¹ æ­£ç¡®çš„å†å²é€‰æ‹©ã€‚
            </div>
            <button class="modal-button" onclick="closeModal()">
                å­¦ä¹ æ­£ç¡®çš„å†å²é€‰æ‹©
            </button>
        </div>
    </div>
    <!-- æ ¸å¿ƒåŠŸèƒ½JSä»£ç  -->
    <script>
        // è·å–æ¨¡æ€çª—å£å…ƒç´ 
        const successModal = document.getElementById('decision-modal');
        const errorModal = document.getElementById('error-modal');
        const modalClose = document.querySelectorAll('.modal-close');
        const modalMessage = document.getElementById('modal-message');
        const errorMessage = document.getElementById('error-message');
        
        // é”™è¯¯é€‰é¡¹çš„åŸå› è¯´æ˜
        const errorReasons = {
            'åŒ—ä¸Šæ¹˜è¥¿': `ä¸é€‰æ‹©åŒ—è¿›æ¹˜è¥¿ï¼Œæ˜¯å› ä¸ºæ¹˜è¥¿æ•Œå†›é‡å…µè®¾ä¼å¸ƒé˜²ï¼Œçº¢å†›ç»æ¹˜æ±Ÿæˆ˜å½¹åæˆ˜åŠ›å—æŸã€ç–²æƒ«ä¸å ªï¼Œè´¸ç„¶åŒ—è¿›æ˜“é­å›´æ­¼ã€‚ä¸”æ¹˜è¥¿åœ°å½¢å¤æ‚ã€è¡¥ç»™å›°éš¾ï¼Œçº¢äºŒã€å…­å†›å›¢ä¸ä¸­å¤®çº¢å†›éš¾ä»¥åŠæ—¶ååŒï¼Œå†›äº‹é£é™©æé«˜ã€‚`,
            'å—ä¸‹å¹¿ä¸œ': `ä¸é€‰æ‹©å—ä¸‹å¹¿ä¸œï¼Œæ˜¯å› ä¸ºå¹¿ä¸œåœ°å¤„æ²¿æµ·ï¼Œå›½æ°‘å…šç»Ÿæ²»åŸºç¡€ç‰¢å›ºï¼Œå…µåŠ›éƒ¨ç½²å¯†é›†ã€‚åŒæ—¶å¹¿ä¸œå¤šä¸˜é™µåœ°å¸¦ï¼Œä¸åˆ©äºå¤§éƒ¨é˜ŸæœºåŠ¨ï¼Œä¸”è¿œç¦»æŠ—æ—¥å‰çº¿ï¼Œä¸ç¬¦åˆ"åŒ—ä¸ŠæŠ—æ—¥"çš„æˆ˜ç•¥æ–¹å‘ï¼Œå®¹æ˜“é™·å…¥è¢«åŠ¨å±€é¢ã€‚`,
            'ä¸œè¿›å‘è¥¿': `ä¸é€‰æ‹©ä¸œè¿›å‘è¥¿ï¼Œæ˜¯å› ä¸ºè¯¥æ–¹å‘æˆ˜ç•¥ç›®æ ‡ä¸æ˜ç¡®ï¼Œå®¹æ˜“åœ¨æ•Œå†›é‡å…µå›´å µä¸‹é™·å…¥æ¥å›å‘¨æ—‹çš„å›°å¢ƒã€‚ä¸œè¿›æ±Ÿè¥¿ä¼šé‡æ–°è¿›å…¥å›½æ°‘å…šé‡ç‚¹é˜²å¾¡åŒºåŸŸï¼Œå‘è¥¿åˆ™å¯èƒ½è¿›å…¥å°‘æ•°æ°‘æ—èšå±…åŒºï¼Œé¢ä¸´è¯­è¨€å’Œæ–‡åŒ–éš”é˜‚ï¼Œä¸åˆ©äºçº¢å†›è¡¥ç»™å’Œå‘å±•ã€‚`
        };
        
        // æ­£ç¡®é€‰é¡¹çš„åŸå› è¯´æ˜
        const correctReasons = {
            'è¥¿è¿›è´µå·': `é€‰æ‹©è¥¿è¿›è´µå·ï¼Œæ ¸å¿ƒåœ¨äºæ‰§è¡Œæ¯›æ³½ä¸œ"é¿å®å‡»è™š"çš„æˆ˜ç•¥æ–¹é’ˆã€‚å½“æ—¶ä¸­å¤®çº¢å†›è‹¥æŒ‰åŸè®¡åˆ’åŒ—ä¸Šæ¹˜è¥¿ä¸çº¢äºŒã€å…­å†›å›¢ä¼šåˆï¼Œå°±ä¼šé™·å…¥è’‹ä»‹çŸ³çš„é‡å…µåŒ…å›´åœˆï¼Œé¢ä¸´å…¨å†›è¦†æ²¡çš„å±é™©ã€‚è€Œè´µå·å†›é˜€ç‹å®¶çƒˆåŠ¿åŠ›å¼±ã€è£…å¤‡å·®ï¼Œè¿˜ä¸è’‹ä»‹çŸ³ä¸­å¤®å†›çŸ›ç›¾é‡é‡ï¼Œç»™çº¢å†›æä¾›äº†çªå›´æœºä¼šã€‚è´µå·å¤šå±±ï¼Œå¦‚å¨„å±±å…³è¿™æ ·é™©å³»çš„åœ°å½¢ï¼Œåˆ©äºçº¢å†›å‘æŒ¥å±±åœ°è¿åŠ¨æˆ˜ç‰¹é•¿ï¼Œé˜»æ»æ•Œå†›è¿½å‡»ã€‚è¿™ä¸€è½¬å‘è®©çº¢å†›æˆåŠŸè·³å‡ºåŒ…å›´åœˆï¼Œæ”»å…‹éµä¹‰è·å¾—ä¼‘æ•´æ—¶æœºï¼Œæ›´ä¸ºéµä¹‰ä¼šè®®æ‰¹åˆ¤é”™è¯¯å†›äº‹è·¯çº¿ã€ç¡®ç«‹æ¯›æ³½ä¸œé¢†å¯¼åœ°ä½åˆ›é€ äº†å†³å®šæ€§æ¡ä»¶ï¼Œä½¿é©å‘½åŠ›é‡é‡è·æˆ˜ç•¥ä¸»åŠ¨æƒï¼Œæˆä¸ºé•¿å¾ç”Ÿæ­»æ”¸å…³çš„è½¬æŠ˜ç‚¹ã€‚`
        };
        
        // æ‰“å¼€æ¨¡æ€çª—å£
        function openModal(type, option) {
            const resultElement = document.getElementById('meeting-result');
            
            if (type === 'correct') {
                const reason = correctReasons[option] || 'ä½ çš„å†³ç­–ä¸çœŸå®å†å²ä¸€è‡´ï¼çº¢å†›é€šè¿‡è¥¿è¿›è´µå·ï¼ŒæˆåŠŸè·³å‡ºæ•Œå†›åŒ…å›´åœˆï¼Œä¸ºé•¿å¾åç»­èƒœåˆ©å¥ å®šåŸºç¡€ã€‚';
                resultElement.textContent = `âœ… å†å²é€‰æ‹©ï¼šä½ çš„å†³ç­–ä¸çœŸå®å†å²ä¸€è‡´ï¼è¥¿è¿›è´µå·æ˜¯éµä¹‰ä¼šè®®å‰çº¢å†›ç”Ÿæ­»æ”¸å…³çš„æ­£ç¡®æˆ˜ç•¥é€‰æ‹©ã€‚\n\nğŸ“Œ é€‰æ‹©è¥¿è¿›è´µå·çš„åŸå› ï¼š${reason}`;
                resultElement.style = 'background-color: #e8f5e9; color: #2e7d32; border-left: 4px solid #2e7d32;';
                
                successModal.style.display = 'flex';
                modalMessage.innerHTML = `<strong>å†å²é€‰æ‹©ï¼š</strong>ä½ çš„å†³ç­–ä¸çœŸå®å†å²ä¸€è‡´ï¼è¥¿è¿›è´µå·æ˜¯éµä¹‰ä¼šè®®å‰çº¢å†›ç”Ÿæ­»æ”¸å…³çš„æ­£ç¡®æˆ˜ç•¥é€‰æ‹©ã€‚<br><br><strong>é€‰æ‹©è¥¿è¿›è´µå·çš„åŸå› ï¼š</strong> ${reason}`;
            } else {
                const reason = errorReasons[option] || 'è¯¥é€‰æ‹©ä¼šå¯¼è‡´çº¢å†›é™·å…¥ä¸åˆ©å±€é¢ï¼Œéµä¹‰ä¼šè®®åŠæ—¶çº æ­£äº†é”™è¯¯å†³ç­–ã€‚';
                resultElement.textContent = `âŒ å†å²æ•™è®­ï¼šé€‰æ‹©ã€Œ${option}ã€ä¼šå¯¼è‡´çº¢å†›é™·å…¥ä¸åˆ©å±€é¢ï¼Œéµä¹‰ä¼šè®®åŠæ—¶çº æ­£äº†é”™è¯¯å†³ç­–ã€‚\n\nğŸ“Œ ä¸é€‰æ‹©${option}çš„åŸå› ï¼š${reason}`;
                resultElement.style = 'background-color: #ffebee; color: #c62828; border-left: 4px solid #c62828;';
                
                errorModal.style.display = 'flex';
                errorMessage.innerHTML = `é€‰æ‹©ã€Œ${option}ã€ä¼šå¯¼è‡´çº¢å†›é™·å…¥ä¸åˆ©å±€é¢ï¼Œéµä¹‰ä¼šè®®åŠæ—¶çº æ­£äº†é”™è¯¯å†³ç­–ã€‚<br><br><strong>ä¸é€‰æ‹©${option}çš„åŸå› ï¼š</strong> ${reason}`;
            }
        }
        
        // å…³é—­æ¨¡æ€çª—å£
        function closeModal() {
            successModal.style.display = 'none';
            errorModal.style.display = 'none';
        }
        
        // ç‚¹å‡»æ¨¡æ€çª—å£å¤–éƒ¨å…³é—­
        window.addEventListener('click', function(e) {
            if (e.target === successModal) {
                successModal.style.display = 'none';
            }
            if (e.target === errorModal) {
                errorModal.style.display = 'none';
            }
        });
        
        // æ¨¡æ€çª—å£å…³é—­æŒ‰é’®ç‚¹å‡»äº‹ä»¶
        modalClose.forEach(close => {
            close.addEventListener('click', closeModal);
        });
        // ====================== äº’åŠ¨å†³ç­–é€»è¾‘ ======================
        function showResult(type, option) {
            openModal(type, option);
        }
        // ====================== è¯­éŸ³æ’­æ”¾åŠŸèƒ½ï¼ˆWeb Speech APIï¼‰ ======================
        function playVoice(type) {
            const speech = new SpeechSynthesisUtterance();
            speech.lang = 'zh-CN'; // è®¾ç½®ä¸ºä¸­æ–‡ï¼ˆæ™®é€šè¯ï¼‰
            speech.rate = 1.0;     // è¯­é€Ÿï¼ˆ1ä¸ºæ­£å¸¸ï¼Œ0.1-10ä¹‹é—´ï¼Œæ•°å€¼è¶Šå¤§è¶Šå¿«ï¼‰
            speech.pitch = 1.0;    // éŸ³é«˜ï¼ˆ1ä¸ºæ­£å¸¸ï¼Œ0-2ä¹‹é—´ï¼‰
            // æ ¹æ®ä¸åŒæ¿å—è®¾ç½®è®²è§£å†…å®¹
            let text = '';
            if (type === 'meeting') {
                text = '1935å¹´1æœˆ15æ—¥è‡³17æ—¥ï¼Œéµä¹‰ä¼šè®®åœ¨è¿™åº§é’ç“¦ç°ç –çš„å°æ¥¼é‡Œå¬å¼€ã€‚ä¼šè®®æŒç»­ä¸‰å¤©ï¼Œé›†ä¸­è§£å†³äº†å½“æ—¶æœ€ç´§è¿«çš„å†›äº‹é—®é¢˜ï¼Œç¡®ç«‹äº†æ¯›æ³½ä¸œåŒå¿—çš„æ­£ç¡®é¢†å¯¼ï¼Œæ ‡å¿—ç€ä¸­å›½å…±äº§å…šå¼€å§‹èµ°å‘æˆç†Ÿã€‚';
            } else if (type === 'folk') {
                text = 'å‚©æˆï¼Œåˆç§°"å‚©å ‚æˆ"ï¼Œåœ¨éµä¹‰åœ°åŒºæµä¼ åƒå¹´ï¼Œæ¼”å‘˜ä½©æˆ´é¢å…·è¡¨æ¼”ï¼Œæ¨¡ä»¿ç¥çµé©±é¬¼é€ç–«ã€‚è€Œéµä¹‰ç¾Šè‚‰ç²‰çš„å†å²å¯è¿½æº¯è‡³æ¸…ä»£ï¼Œå¦‚ä»Šå·²æˆä¸ºéµä¹‰çš„åŸå¸‚åç‰‡ï¼Œä¸€ç¢—ç²‰æ‰¿è½½ç€å½“åœ°äººçš„ä¹¡æ„ã€‚';
            }
            speech.text = text;
            window.speechSynthesis.speak(speech); // å¼€å§‹æ’­æ”¾è¯­éŸ³
        }
         // ====================== ç™¾åº¦åœ°å›¾åˆå§‹åŒ– ======================
        function initBaiduMap() {
            const map = new BMap.Map('map'); // ç»‘å®šHTMLä¸­çš„åœ°å›¾å®¹å™¨ï¼ˆid="map"ï¼‰
            const defaultPoint = new BMap.Point(106.9046, 27.6972); // éµä¹‰ä¼šè®®ä¼šå€åæ ‡ï¼ˆç»åº¦, çº¬åº¦ï¼‰
            map.centerAndZoom(defaultPoint, 14); // åˆå§‹åŒ–åœ°å›¾ä¸­å¿ƒå’Œç¼©æ”¾çº§åˆ«ï¼ˆ14çº§ä¸ºå¸‚åŒºèŒƒå›´ï¼‰
            map.enableScrollWheelZoom(true); // å¯ç”¨é¼ æ ‡æ»šè½®ç¼©æ”¾åœ°å›¾
            
            // æ™¯ç‚¹æŒ‰é’®ç‚¹å‡»äº‹ä»¶ï¼šå®šä½åˆ°å¯¹åº”åæ ‡å¹¶æ˜¾ç¤ºæ ‡è®°
            document.querySelectorAll('.map-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const lat = this.dataset.lat; // è·å–data-latå±æ€§å€¼ï¼ˆçº¬åº¦ï¼‰
                    const lng = this.dataset.lng; // è·å–data-lngå±æ€§å€¼ï¼ˆç»åº¦ï¼‰
                    const point = new BMap.Point(lng, lat); // ç™¾åº¦åœ°å›¾åæ ‡æ ¼å¼ä¸ºï¼ˆç»åº¦, çº¬åº¦ï¼‰
                    map.panTo(point); // å¹³ç§»åœ°å›¾ä¸­å¿ƒåˆ°ç›®æ ‡åæ ‡
                    
                    // æ¸…é™¤ä¹‹å‰çš„æ ‡è®°ï¼Œæ·»åŠ æ–°æ ‡è®°
                    map.clearOverlays(); // æ¸…é™¤æ‰€æœ‰è¦†ç›–ç‰©
                    const marker = new BMap.Marker(point); // åˆ›å»ºæ ‡è®°
                    map.addOverlay(marker); // åœ¨åœ°å›¾ä¸Šæ˜¾ç¤ºæ ‡è®°
                    
                    // ç‚¹å‡»æ ‡è®°æ˜¾ç¤ºä¿¡æ¯çª—å£ï¼ˆå¯é€‰åŠŸèƒ½ï¼‰
                    marker.addEventListener('click', function() {
                        const infoWindow = new BMap.InfoWindow(`<h4>${this.parentNode.textContent}</h4>`);
                        map.openInfoWindow(infoWindow, point); // åœ¨æ ‡è®°ä½ç½®æ‰“å¼€ä¿¡æ¯çª—å£
                    });
                });
            });
        }

        // åŠ è½½ç™¾åº¦åœ°å›¾APIï¼ˆå¿…é¡»æ›¿æ¢YOUR_AKä¸ºä½ çš„çœŸå®å¯†é’¥ï¼‰
        const baiduApiKey = '0CW0Uf4qmyUj6p0Bz8VaiZGWSzyZvShS'; // é‡è¦ï¼æ­¤å¤„æ›¿æ¢ä¸ºä½ ç”³è¯·çš„ç™¾åº¦åœ°å›¾AKå¯†é’¥
        const script = document.createElement('script');
        script.src = `https://api.map.baidu.com/api?v=3.0&ak=${baiduApiKey}&callback=initBaiduMap`;
        script.async = true; // å¼‚æ­¥åŠ è½½ï¼Œä¸é˜»å¡é¡µé¢æ¸²æŸ“
        document.head.appendChild(script); // å°†APIè„šæœ¬æ·»åŠ åˆ°HTMLå¤´éƒ¨
        // ====================== çº¢è‰²æ•…äº‹åˆ›ä½œåŠŸèƒ½ ======================
        // å®šä¹‰ API Key
        const apiKey = 'sk-5f13af0b28ff4f31a50234f750e96924'; // è¯·å°†è¿™é‡Œæ›¿æ¢ä¸ºä½ çš„å®é™… API Key
        // ä¸»é¢˜é€‰é¡¹ç‚¹å‡»äº‹ä»¶
        document.querySelectorAll('.theme-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.theme-option').forEach(opt => {
                    opt.classList.remove('active');
                });
                this.classList.add('active');
                document.getElementById('story-theme').value = this.dataset.theme;
            });
        });
        
        // æŒ‰å›è½¦é”®è§¦å‘ç”Ÿæˆ
        document.getElementById('story-theme').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                generateStory();
            }
        });
        async function generateStory() {
            const theme = document.getElementById('story-theme').value.trim();
            const details = document.getElementById('story-details').value.trim();
            const style = document.getElementById('story-style').value;
            const length = document.getElementById('story-length').value;
            
            const resultDiv = document.getElementById('result'); // ä¿æŒä½¿ç”¨result IDï¼Œè¿™æ˜¯çº¢è‰²æ•…äº‹çš„ç»“æœå®¹å™¨
            const resultStatus = document.getElementById('result-status');
            const generateBtn = document.getElementById('generate-btn');
            const loadingSpinner = document.getElementById('loading-spinner');
            
            if (!theme) {
                alert('è¯·é€‰æ‹©æˆ–è¾“å…¥æ•…äº‹ä¸»é¢˜ï¼');
                return;
            }
            
            // ç¦ç”¨æŒ‰é’®å¹¶æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
            generateBtn.disabled = true;
            loadingSpinner.style.display = 'inline-block';
            resultStatus.textContent = 'AIæ­£åœ¨åˆ›ä½œä¸­...';
            resultDiv.innerHTML = '<em>æ­£åœ¨åˆ›ä½œå…³äºã€Œ' + theme + 'ã€çš„çº¢è‰²æ•…äº‹...</em>';
            
            try {
                const prompt = `è¯·åˆ›ä½œä¸€ç¯‡å…³äº${theme}çš„çº¢è‰²æ•…äº‹ï¼Œè¦æ±‚ï¼š
1. ä¸»é¢˜ï¼š${theme}
2. é£æ ¼ï¼š${style}
3. é•¿åº¦ï¼š${length}
4. ä½“ç°çº¢è‰²æ–‡åŒ–å’Œé©å‘½ç²¾ç¥
5. æ•…äº‹è¦æœ‰çœŸå®æ„Ÿï¼Œå¯ä»¥é€‚å½“è‰ºæœ¯åŠ å·¥
6. åŒ…å«å…·ä½“äººç‰©å’Œæƒ…èŠ‚
7. ç»“å°¾è¦æœ‰æ•™è‚²æ„ä¹‰å’Œå¯ç¤º
${details ? "é¢å¤–è¦æ±‚ï¼š" + details : ""}
è¯·æŒ‰ç…§ä»¥ä¸‹æ ¼å¼è¾“å‡ºï¼š
ã€æ ‡é¢˜ã€‘ 
ï¼ˆç©ºä¸€è¡Œï¼‰
ã€æ­£æ–‡ã€‘`;
                const response = await fetch('https://api.deepseek.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}` // ä½¿ç”¨å®šä¹‰çš„ API Key
                    },
                    body: JSON.stringify({
                        model: 'deepseek-chat',
                        messages: [
                            {
                                role: 'user',
                                content: prompt
                            }
                        ],
                        temperature: 0.7,
                        max_tokens: 2000
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`APIè¯·æ±‚å¤±è´¥: ${response.status}`);
                }
                
                const data = await response.json();
                const story = data.choices[0].message.content;
                
                // æ ¼å¼åŒ–æ•…äº‹æ–‡æœ¬
                const formattedStory = story
                   .replace(/ã€æ ‡é¢˜ã€‘/g, '<h3 style="color:var(--primary-red);text-align:center;">')
                   .replace(/ã€æ­£æ–‡ã€‘/g, '</h3>')
                   .replace(/\n\n/g, '</p><p>')
                   .replace(/\n/g, '<br>');
                
                resultDiv.innerHTML = '<p>' + formattedStory + '</p>';
                resultStatus.textContent = 'åˆ›ä½œæˆåŠŸï¼';
                resultStatus.style.color = 'var(--primary-red)';
                
            } catch (error) {
                console.error('APIè°ƒç”¨é”™è¯¯:', error);
                resultDiv.innerHTML = `<span style="color:var(--primary-red)">ç”Ÿæˆå¤±è´¥: ${error.message}<br>è¯·æ£€æŸ¥API Keyæ˜¯å¦æ­£ç¡®æˆ–ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸</span>`;
                resultStatus.textContent = 'åˆ›ä½œå¤±è´¥';
                resultStatus.style.color = 'var(--primary-red)';
            } finally {
                // æ¢å¤æŒ‰é’®çŠ¶æ€
                generateBtn.disabled = false;
                loadingSpinner.style.display = 'none';
            }
        }
        
        function copyStory() {
            const resultDiv = document.getElementById('result');
            const range = document.createRange();
            range.selectNode(resultDiv);
            window.getSelection().removeAllRanges();
            window.getSelection().addRange(range);
            document.execCommand('copy');
            window.getSelection().removeAllRanges();
            
            alert('æ•…äº‹å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
        }
        
        function downloadStory() {
            const storyText = document.getElementById('result').innerText;
            const theme = document.getElementById('story-theme').value.trim() || 'çº¢è‰²æ•…äº‹';
            const blob = new Blob([storyText], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${theme}-${new Date().toLocaleDateString()}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        // ====================== å¹³æ»‘æ»šåŠ¨ ======================
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                
                const targetId = this.getAttribute('href');
                const targetElement = document.querySelector(targetId);
                
                if (targetElement) {
                    window.scrollTo({
                        top: targetElement.offsetTop - 100,
                        behavior: 'smooth'
                    });
                }
            });
        });
    </script>
</body>
</html>